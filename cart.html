<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ—Ä–∑–∏–Ω–∞ - Neo Vape</title>
    <meta name="description" content="–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ Neo Vape. –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–≤–∞—Ä —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π.">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <img src="Logotip.jpg" alt="Neo Vape" class="logo" onerror="this.src='https://i.imgur.com/5VxY7bK.png'">
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="–ò—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä—ã...">
        <button id="searchBtn">üîç</button>
    </div>
    <a href="cart.html" id="cartLink">üõí –ö–æ—Ä–∑–∏–Ω–∞ (<span id="cartCount">0</span>)</a>
</header>

<main class="container">

    <h2>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>

    <div id="cartItems">
        <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
    </div>

    <div class="cart-total">
        <strong>–ò—Ç–æ–≥–æ:</strong> <span id="totalPrice">0.00 ‚ÇΩ</span>
    </div>

    <div class="cart-actions">
        <a href="index.html" class="btn btn-secondary">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
        <button id="clearCart" class="btn btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
        <button id="checkout" class="btn btn-primary">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </div>

</main>

<script>
    // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï =====
    let cart = JSON.parse(localStorage.getItem('smokeBobCart')) || [];

    // ===== –°–û–•–†–ê–ù–ï–ù–ò–ï =====
    function saveCart() {
        localStorage.setItem('smokeBobCart', JSON.stringify(cart));
        updateCartCount();
    }

    // ===== –°–ß–Å–¢–ß–ò–ö –ö–û–†–ó–ò–ù–´ =====
    function updateCartCount() {
        const count = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById('cartCount').textContent = count;
    }

    // ===== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ö–û–†–ó–ò–ù–´ =====
    function renderCart() {
        const container = document.getElementById('cartItems');
        const totalEl = document.getElementById('totalPrice');
        if (!container || !totalEl) return;

        updateCartCount();

        if (cart.length === 0) {
            container.innerHTML = '<p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üò¢</p>';
            totalEl.textContent = '0.00 ‚ÇΩ';
            return;
        }

        let total = 0;
        let html = cart.map(item => {
            const itemTotal = item.price * item.quantity;
            total += itemTotal;
            return `
                <div class="cart-item">
                    <img src="${item.image}" class="cart-item-image">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-sku">–ê—Ä—Ç–∏–∫—É–ª: ${item.sku}</div>
                        <div class="cart-item-description">${item.description}</div>
                    </div>
                    <div class="cart-item-price">${itemTotal.toFixed(2)} ‚ÇΩ</div>
                    <div class="cart-item-controls">
                        <input type="number" class="quantity-input" value="${item.quantity}" min="1" onchange="updateQuantity(${item.productId}, this.value)">
                        <button class="remove-btn" onclick="removeItem(${item.productId})">√ó</button>
                    </div>
                </div>
            `;
        }).join('');

        container.innerHTML = html;
        totalEl.textContent = `${total.toFixed(2)} ‚ÇΩ`;
    }

    // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–û–†–ó–ò–ù–û–ô =====
    function removeItem(productId) {
        cart = cart.filter(item => item.productId !== productId);
        saveCart();
        renderCart();
    }

    function updateQuantity(productId, newQty) {
        const item = cart.find(i => i.productId === productId);
        if (item && newQty > 0) {
            item.quantity = parseInt(newQty);
            saveCart();
            renderCart();
        }
    }

    // ===== –û–ß–ò–°–¢–ò–¢–¨ –ö–û–†–ó–ò–ù–£ =====
    document.getElementById('clearCart')?.addEventListener('click', () => {
        if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) {
            cart = [];
            saveCart();
            renderCart();
        }
    });

    // ===== –û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó =====
    document.getElementById('checkout')?.addEventListener('click', () => {
        if (cart.length === 0) {
            alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!');
            return;
        }
        alert('üéâ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!');
        cart = [];
        saveCart();
        renderCart();
        window.location.href = 'contacts.html';
    });

    // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
    document.addEventListener('DOMContentLoaded', () => {
        updateCartCount();
        renderCart();
    });
</script>

</body>
</html>